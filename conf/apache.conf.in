# To install on a Debian system:
# 1) Symlink this into: /etc/apache2/sites-available/
# 2) Then do a: a2ensite <symlink-name>

# Put this in your main Apache config, or just uncomment the line bellow.
# WSGIDaemonProcess django processes=4 threads=8 stack-size=524288 display-name=(wsgi:normal.no)

# TODO: add to main apache config
# WSGIRestrictEmbedded On

# Normalize urls: www.normal.no -> normal.no
# Note: normal.no/foo -> normal.no/foo/ is done by Django (APPEND_SLASH)
# @todo remove ServerAlias bellow *before* activating this!
# @todo remove www.normal.no from ALLOWED_HOSTS
#<VirtualHost *:80>
#    ServerName www.normal.no
#    Redirect permanent / http://normal.no/
#    Redirect permanent / ///normal.no/ # ok? also works with https
#</VirtualHost>


<VirtualHost *:80>
    ServerName	    @DOMAIN@
    ServerAlias	    www.@DOMAIN@
    ServerAlias	    normal.i2p
    ServerAlias	    qrw3w45sx7niqcpg.onion
    ServerAdmin	    torkel@normal.no

    Alias /static/      @PREFIX@/htdocs/static/
    Alias /media/       @PREFIX@/htdocs/media/
    #Alias /favicon.ico @PREFIX@/htdocs/static/favicon.ico
    #Alias /robots.txt  @PREFIX@/htdocs/static/robots.txt

    WSGIScriptAlias /   @PREFIX@/django/website/wsgi.py
    WSGIProcessGroup    django

    CustomLog           @PREFIX@/logs/access.log combined
    ErrorLog            @PREFIX@/logs/error.log
    # @todo dont' use .log prefix since clashes with django logs
    #CustomLog logs/referer_log "%{Referer}i -> %U"
    #CustomLog logs/agent_log "%{User-agent}i"
    # %D    The time taken to serve the request, in microseconds.
    # SetEnvIf Request_URI \.gif$ gif-image
    #   don't log access

    ## Access control (ACL)
    <Directory @PREFIX@/htdocs>
        Allow from all
        Options none
        AllowOverride none
    </Directory>

    <Directory @PREFIX@/django/website>
        <Files wsgi.py>
            Order deny,allow
            Allow from all
        </Files>
    </Directory>

    # This should already be your default setting
#    <Directory />
#       Order deny,allow
#       Deny from all
#    </Directory>
</VirtualHost>
