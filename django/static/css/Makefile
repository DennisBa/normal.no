# @todo prefix or put autogenerated css files in own directory
# @todo only all.css should be copied by collectstatic. how?
# django/manage.py collectstatic --noinput -i \*.less -i Makefile

LESSC=lessc

# Note: --clean-css compress a little bit better than --compress
LESSCFLAGS=--no-js --clean-css
#LESSCFLAGS=--global-var=BG=red

# Convert all less files to css.
# @todo some files can not be merged, like tinymcs inline styles.
#       so better to manually list files to concat
cssfiles := $(patsubst %.less,%.css,$(wildcard *.less))


all.css: $(cssfiles)
	cat $(cssfiles) > all.css

# drawback: will regenerate all css files even if .less not
# changed. so better to move all src files out of static dir
# so not picked up by collectstatic
#rm $(cssfiles)

clean:
	rm -fv all.css
	rm -fv $(cssfiles)


%.css : %.less
	$(LESSC) $(LESSCFLAGS) $^ > $@
